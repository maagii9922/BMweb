<main>
    <div class="container-fluid px-4">
        <h5 class="mt-4">Харилцагч шинээр бүртгүүлэх</h5>
        <ol class="breadcrumb mb-4">
        </ol>
        <div class="card mb-4">
            
            <div class="card-body">
                <div class="dataTable-top">
                    <div class="dataTable-dropdown"> 
                        {% if errmsg %}
                        <div id ="errmsg" class="alert alert-danger" role="alert">
                        {{errmsg}}
                        </div>
                        {% endif %} 
                        <form method='POST' id="reg_com_form" >
                            {% csrf_token %}
                            <div class="mb-3">
                                <label for="comName" class="form-label">Харилцагчийн нэр:</label>
                                <input type="text" class="form-control" id="comName" name="comName" placeholder="Харилцагчийн нэр" required onblur="checkValid()" value="{{data.comName}}"/>
                              </div>
                              <div class="mb-3">
                                <label for="hayag" class="form-label">Харилцагчийн хаяг:</label>
                                <input type="text" class="form-control" id="hayag" name="hayag" placeholder="Харилцагчийн хаяг" required onblur="checkValid()" value="{{data.hayag}}"/>
                              </div>
                              <div class="mb-3">
                                <label for="phone" class="form-label">Харилцагчийн утас:</label>
                                <input type="text" class="form-control" id="phone" name="phone" placeholder="Харилцагчийн утас" required onblur="checkValid()" value="{{data.phone}}"/>
                              </div>                              
                              <div class="mb-3">{{upFile}}::
                                <label for="thumbimage" class="form-label">Зураг:</label>
                                <input type="button" class="form-control form-control-sm" value="Зураг оруулах" onclick="bt1_click()" > 
                                <input type="file" class="form-control form-control-sm" id="thumbimage" name="thumbimage" placeholder="Зураг" required onblur="checkValid()" value="{{data.thumbimage}}" multiple/>
                              </div>
                              <!-- <div class="mb-3">
                                <label for="description" class="form-label">Тайлбар:</label>
                                <input type="text" class="form-control" id="description" name="description" placeholder="Тайлбар" required onblur="checkValid()" value="{{data.description}}"/>
                              </div> -->
                            <!-- {{ProductForm.id}} -->
                            <!-- <input id="had" type='submit'  value='Хадгалах' onclick="hadgalah()"/> -->
                            {% if edit %} <input type='hidden' name='edit' value='{{edit}}'id="edit"/>
                                <button type="submit" class="btn btn-primary" id="had" >Хадгалах</button> 
                            {% else %}
                                <button type="submit" class="btn btn-primary" id="had" disabled>Хадгалах</button>
                            {% endif %}
                          

                            <script>
                                // function checkValid(){                                
                                //     const form = document.getElementById('reg_com_form');
                                //     form.addEventListener("change", () => {
                                //         document.getElementById('had').disabled = !form.checkValidity()
                                //     });
                                // }
                                

                             window.addEventListener('load', (event) => {console.log('page is fully loaded');

                                const form = document.getElementById('reg_com_form');
                                form.addEventListener("change", () => {console.log('onchange')
                                    document.getElementById('had').disabled = !form.checkValidity()
                                });




                                document.getElementById("thumbimage").onchange = function () { console.log('thumbimage-onchange',this.files.length)
                                parent=this.parentElement;console.log( parent.childNodes)
                                for( let i =0; parent.childNodes[6]; i++){ 
                                parent.removeChild(parent.childNodes[6])      
                                }

                                for( let i =0; i<this.files.length; i++){ 
                                    const img = document.createElement("img");
                                    img.src = URL.createObjectURL(this.files[i]);
                                    img.style.height=150+"px"
                                    parent.appendChild(img)     

                                }
                                };

                                });



                                function bt1_click(){
                                console.log('btn1')
                                b = document.getElementById('thumbimage').click();
                                }


                                                    // $(document).ready(function() {    
                                //         $('#had').prop('disabled', true);
                                //             if ($('#edit').val())
                                //             {
                                //                 $('#had').prop('disabled', false);
                                //             }
                                //             else
                                //             {
                                //                 $('#had').prop('disabled', true);
                                //             }
                                      
                                //     });

                            </script>                              
                   
                        </form>
                </div>
                <div>
                        
                </div>
                
            </div>
           
        </div>
    </div>
</main>

